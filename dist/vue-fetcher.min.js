/**
 * vue-fetcher v1.1.0 (2018-02-22)
 * Copyright 2018 Oliver Findl
 * @license MIT
 */
class VueFetcher{constructor(t){t=t||{},this._options={base:this._trim(t.base||"static/vue","BASE"),componentDir:this._trim(t.componentDir||"components","DIR"),templateDir:this._trim(t.templateDir||"templates","DIR"),componentExt:this._trim(t.componentExt||".vue.js","EXT"),templateExt:this._trim(t.templateExt||".vue.html","EXT"),globalName:t.globalName||"VueFetcher"},this._axios=!!window.hasOwnProperty("axios"),this._method=(this._axios?window.axios.get:window.fetch).bind(window),this._logTitle="[vue-fetcher]: ",this._errorTitle=this._logTitle.replace(/\]/," error]"),this.components={},window.hasOwnProperty(this._options.globalName)?this._error("cannot set VueFetcher class as global variable to window."+this._options.globalName+", please do it manually"):window[this._options.globalName]=this}_get(t){if(t)return this.components.hasOwnProperty(t)?this.components[t]:null;this._error("missing required arguments")}_set(t){if(t&&t.name)return!!(this.components[t.name]=t);this._error("missing required arguments")}_trim(t,e){if(t&&e){if(t=t.trim(),!this._canTrim(t,e))return t;switch(e.toUpperCase()){case"BASE":return t.replace(/\/+$/g,"");case"DIR":return t.replace(/^\/+|\/+$/g,"");case"EXT":return t.replace(/^\.+/g,".");case"COMPONENT-AS-STRING":return t.replace(/^[^{]+|[^}]+$/g,"");default:return t}}else this._error("missing required arguments")}_canTrim(t,e){if(t&&e)switch(e.toUpperCase()){case"BASE":case"DIR":case"EXT":return!!t.match(/\w+/g);default:return!0}else this._error("missing required arguments")}_replace(t,e){if(t&&e)switch(e.toUpperCase()){case"COMPONENT-NAME":return t.replace(/\//g,"--");default:return t}else this._error("missing required arguments")}_log(){return Array.prototype.unshift.call(arguments,this._logTitle),console.log.apply(this,arguments)}_error(){return Array.prototype.unshift.call(arguments,this._errorTitle),console.error.apply(this,arguments)}push(t){if(t&&t.name)return!this._get(t.name)&&this._set(t);this._error("missing required arguments")}fetch(t){if(t)return(e,r)=>{let i=this._get(t);i?e(i):this._method([this._options.base,this._options.componentDir,t].join("/")+this._options.componentExt).then(e=>{if(this._axios&&[200,304].indexOf(e.status)>-1)return e.data;if(e.ok)return e.text();{let e="component fetch failed ["+t+"]";return this._error(e),void r(e)}}).then(i=>{if(!i){let e="component check failed ["+t+"]";return this._error(e),void r(e)}try{i=window.eval("new window.Object("+this._trim(i.toString(),"COMPONENT-AS-STRING")+")")}catch(e){this._error(e);let i="component eval failed ["+t+"]";return this._error(i),void r(i)}i.hasOwnProperty("name")&&i.name.length||(i.name=this._replace(t,"COMPONENT-NAME"));let s=null;const o=/^\s*(path|file|url):\s*/i;if(i.hasOwnProperty("template")&&i.template.length&&!(s=o.test(i.template)))return i.template=i.template.replace(/^\s*(id|html):\s*/i,""),this._set(i),void e(i);this._method(s?i.template.replace(o,""):[this._options.base,this._options.templateDir,t].join("/")+this._options.templateExt).then(e=>{if(this._axios&&[200,304].indexOf(e.status)>-1)return e.data;if(e.ok)return e.text();{let e="template fetch failed ["+t+"]";return this._error(e),void r(e)}}).then(s=>{if(!s){let e="template check failed ["+t+"]";return this._error(e),void r(e)}i.template=s.toString(),this._set(i),e(i)}).catch(e=>{this._error(e);let i="fetch template catch ["+t+"]";this._error(i),r(i)})}).catch(e=>{this._error(e);let i="fetch component catch ["+t+"]";this._error(i),r(i)})};this._error("missing required arguments")}}