/**
 * vue-fetcher v1.1.2 (2018-02-23)
 * Copyright 2018 Oliver Findl
 * @license MIT
 */
class VueFetcher{constructor(e){e=e||{},this._options={base:this._trim(e.base||"static/vue","BASE"),componentDir:this._trim(e.componentDir||"components","DIR"),templateDir:this._trim(e.templateDir||"templates","DIR"),componentExt:this._trim(e.componentExt||".vue.js","EXT"),templateExt:this._trim(e.templateExt||".vue.html","EXT"),globalName:e.globalName||"VueFetcher"},this._axios=!!window.hasOwnProperty("axios"),this._method=(this._axios?window.axios.get:window.fetch).bind(window),this.components={},window.hasOwnProperty(this._options.globalName)?this._console("error","cannot set VueFetcher class as global variable to window."+this._options.globalName+", please do it manually"):window[this._options.globalName]=this}_get(e){if(e)return this.components.hasOwnProperty(e)?this.components[e]:null;this._console("error","missing required arguments")}_set(e){if(e&&e.name)return!!(this.components[e.name]=e);this._console("error","missing required arguments")}_trim(e,t){if(e&&t){if(e=e.trim(),!this._canTrim(e,t))return e;switch(t.toUpperCase()){case"BASE":return e.replace(/\/+$/g,"");case"DIR":return e.replace(/^\/+|\/+$/g,"");case"EXT":return e.replace(/^\.+/g,".");case"COMPONENT-AS-STRING":return e.replace(/^[^{]+|[^}]+$/g,"");default:return e}}else this._console("error","missing required arguments")}_canTrim(e,t){if(e&&t)switch(t.toUpperCase()){case"BASE":case"DIR":case"EXT":return!!e.match(/\w+/g);default:return!0}else this._console("error","missing required arguments")}_replace(e,t){if(e&&t)switch(t.toUpperCase()){case"COMPONENT-NAME":return e.replace(/\//g,"--");default:return e}else this._console("error","missing required arguments")}_console(){let e=window.Array.prototype.shift.call(arguments);if(e&&e.length&&-1!==["info","log","error","trace","warn"].indexOf(e)&&window.console.hasOwnProperty(e))return window.Array.prototype.unshift.call(arguments,"[vue-fetcher]["+e+"]"),window.console[e].apply(null,arguments)}push(e){if(e&&e.name)return!this._get(e.name)&&this._set(e);this._console("error","missing required arguments")}fetch(e){if(e)return(t,r)=>{let s=this._get(e);s?t(s):this._method([this._options.base,this._options.componentDir,e].join("/")+this._options.componentExt).then(t=>{if(this._axios&&[200,304].indexOf(t.status)>-1)return t.data;if(t.ok)return t.text();{let t="component fetch failed ["+e+"]";return this._console("error",t),void r(t)}}).then(s=>{if(!s){let t="component check failed ["+e+"]";return this._console("error",t),void r(t)}try{s=window.eval("new window.Object("+this._trim(s.toString(),"COMPONENT-AS-STRING")+")")}catch(t){this._console("error",t);let s="component eval failed ["+e+"]";return this._console("error",s),void r(s)}s.hasOwnProperty("name")&&s.name.length||(s.name=this._replace(e,"COMPONENT-NAME"));let o=null;const i=/^\s*(path|file|url):\s*/i;if(s.hasOwnProperty("template")&&s.template.length&&!(o=i.test(s.template)))return/^\s*!inline\s*/i.test(s.template)?delete s.template:s.template=s.template.replace(/^\s*(id|html):\s*/i,""),this._set(s),void t(s);this._method(o?s.template.replace(i,""):[this._options.base,this._options.templateDir,e].join("/")+this._options.templateExt).then(t=>{if(this._axios&&[200,304].indexOf(t.status)>-1)return t.data;if(t.ok)return t.text();{let t="template fetch failed ["+e+"]";return this._console("error",t),void r(t)}}).then(o=>{if(!o){let t="template check failed ["+e+"]";return this._console("error",t),void r(t)}s.template=o.toString(),this._set(s),t(s)}).catch(t=>{this._console("error",t);let s="fetch template catch ["+e+"]";this._console("error",s),r(s)})}).catch(t=>{this._console("error",t);let s="fetch component catch ["+e+"]";this._console("error",s),r(s)})};this._console("error","missing required arguments")}}