/**
 * vue-fetcher v1.0.2 (2017-12-26)
 * Copyright 2017 Oliver Findl
 * @license MIT
 */
class VueFetcher{constructor(e){e=e||{},this._options={base:this._trim(e.base||"static/vue","BASE"),componentDir:this._trim(e.componentDir||"components","DIR"),templateDir:this._trim(e.templateDir||"templates","DIR"),componentExt:this._trim(e.componentExt||".vue.js","EXT"),templateExt:this._trim(e.templateExt||".vue.html","EXT"),globalName:e.globalName||"VueFetcher"},this._axios=!!window.hasOwnProperty("axios"),this._method=(this._axios?window.axios.get:window.fetch).bind(window),this._logTitle="[vue-fetcher]: ",this._errorTitle=this._logTitle.replace(/\]/," error]"),this.components={},window.hasOwnProperty(this._options.globalName)?console.error(this._errorTitle+"cannot set VueFetcher class as global variable to window.%s, please do it manually",this._options.globalName):window[this._options.globalName]=this}_get(e){if(e)return this.components.hasOwnProperty(e)?this.components[e]:null;console.error(this._errorTitle+"missing required arguments")}_set(e){if(e&&e.name)return!!(this.components[e.name]=e);console.error(this._errorTitle+"missing required arguments")}_trim(e,t){if(e&&t){if(e=e.trim(),!this._canTrim(e,t))return e;switch(t.toUpperCase()){case"BASE":return e.replace(/\/+$/g,"");case"DIR":return e.replace(/^\/+|\/+$/g,"");case"EXT":return e.replace(/^\.+/g,".");case"COMPONENT-AS-STRING":return e.replace(/^[^{]+|[^}]+$/g,"");default:return e}}else console.error(this._errorTitle+"missing required arguments")}_canTrim(e,t){if(e&&t)switch(t.toUpperCase()){case"BASE":case"DIR":case"EXT":return!!e.match(/\w+/g);default:return!0}else console.error(this._errorTitle+"missing required arguments")}_replace(e,t){if(e&&t)switch(t.toUpperCase()){case"COMPONENT-NAME":return e.replace(/\//g,"--");default:return e}else console.error(this._errorTitle+"missing required arguments")}push(e){if(e&&e.name)return!this._get(e.name)&&this._set(e);console.error(this._errorTitle+"missing required arguments")}fetch(e){if(e)return(t,r)=>{let i=this._get(e);i?t(i):this._method([this._options.base,this._options.componentDir,e].join("/")+this._options.componentExt).then(t=>{if(this._axios&&[200,304].indexOf(t.status)>-1)return t.data;if(t.ok)return t.text();{let t=this._errorTitle+"component fetch failed";return console.error(t+" [%s]",e),void r(t)}}).then(i=>{if(!i){let t=this._errorTitle+"component check failed";return console.error(t+" [%s]",e),void r(t)}try{i=window.eval("new window.Object("+this._trim(i.toString(),"COMPONENT-AS-STRING")+")")}catch(t){return console.error(this._errorTitle+"component eval failed [%s]",e),console.error(t),void r(t)}if(i.hasOwnProperty("name")&&i.name.length||(i.name=this._replace(e,"COMPONENT-NAME")),i.hasOwnProperty("template")&&i.template.length)return this._set(i),void t(i);this._method([this._options.base,this._options.templateDir,e].join("/")+this._options.templateExt).then(t=>{if(this._axios&&[200,304].indexOf(t.status)>-1)return t.data;if(t.ok)return t.text();{let t=this._errorTitle+"template fetch failed";return console.error(t+" [%s]",e),void r(t)}}).then(o=>{if(!o){let t=this._errorTitle+"template check failed";return console.error(t+" [%s]",e),void r(t)}i.template=o.toString(),this._set(i),t(i)}).catch(t=>{console.error(this._errorTitle+"fetch template catch [%s]",e),console.error(t),r(t)})}).catch(t=>{console.error(this._errorTitle+"fetch component catch [%s]",e),console.error(t),r(t)})};console.error(this._errorTitle+"missing required arguments")}}