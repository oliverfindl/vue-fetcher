"use strict";var _createClass=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var VueFetcher=function(){function a(){var b=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,a),this._name="vue-fetcher",this._axios=window.hasOwnProperty("axios"),this._method=(this._axios?window.axios.get:window.fetch).bind(window),this._ok=[200,304],this._patterns={trimBase:/\/+$/,trimDirectory:/^\/+|\/+$/g,trimExtension:/^\.+/,testComponentString:/{[\s\S]*}/,trimComponentString:/^[^{]+|[^}]+$/g,testComponentName:/^[\w-]+$/,testTemplateString:/<[\s\S]+>/,testTemplateBasic:/^\s*(id|html):\s*/i,testTemplateInline:/^\s*!inline\s*/i,testTemplatePath:/^\s*(path|file|url):\s*/i,replaceWhitespace:/\s+/g,replaceSpecial:/[^\w\-]+/g,replaceSlash:/\/+/g,trimDash:/^-+|-+$/g},this._options={base:(b.base||"static/vue").replace(this._patterns.trimBase,""),componentDirectory:(b.componentDirectory||"components").replace(this._patterns.trimDirectory,""),templateDirectory:(b.templateDirectory||"templates").replace(this._patterns.trimDirectory,""),componentExtension:(b.componentExtension||"vue.js").replace(this._patterns.trimExtension,""),templateExtension:(b.templateExtension||"vue.html").replace(this._patterns.trimExtension,"")},this.components={}}return _createClass(a,[{key:"_get",value:function b(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"";return a&&a.length?this.components.hasOwnProperty(a)?this.components[a]:null:void this._console("error","missing required arguments")}},{key:"_set",value:function b(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return a&&a.hasOwnProperty("name")&&a.name.length?!!(this.components[a.name]=a):void this._console("error","missing required arguments")}},{key:"_slug",value:function b(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"";return a&&a.length?a.toLowerCase().replace(this._patterns.replaceWhitespace,"-").replace(this._patterns.replaceSlash,"--").replace(this._patterns.replaceSpecial,"").replace(this._patterns.trimDash,""):void this._console("error","missing required arguments")}},{key:"_console",value:function b(){var a=window.Array.prototype.shift.call(arguments);if(a&&a.length&&["debug","error","info","log","trace","warn"].includes(a)&&window.console.hasOwnProperty(a))return window.Array.prototype.unshift.call(arguments,"["+this._name+"]["+a+"]"),window.console[a].apply(null,arguments)}},{key:"push",value:function b(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return a&&a.hasOwnProperty("name")&&a.name.length?!this._get(a.name)&&this._set(a):void this._console("error","missing required arguments")}},{key:"fetch",value:function c(){var a=this,b=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"";return b&&b.length?function(c,d){var e=a._get(b);return e&&e.hasOwnProperty("name")&&e.name.length?void c(e):void a._method([[a._options.base,a._options.componentDirectory,b].join("/"),a._options.componentExtension].join(".")).then(function(c){if(a._ok.includes(c.status))return a._axios?c.data.toString():c.text();var e="component fetch failed ["+b+"]";return a._console("error",e),void d(e)}).then(function(e){if(!e||!e.length||!a._patterns.testComponentString.test(e)){var g="component check failed ["+b+"]";return a._console("error",g),void d(g)}try{e=window.eval.call(null,"new window.Object("+e.replace(a._patterns.trimComponentString,"")+");")}catch(c){a._console("error",c);var h="component eval failed ["+b+"]";return a._console("error",h),void d(h)}e.hasOwnProperty("name")&&e.name.length&&a._patterns.testComponentName.test(e.name)||(e.name=a._slug(b));var f=null;return e.hasOwnProperty("template")&&e.template.length&&!(f=a._patterns.testTemplatePath.test(e.template))?(a._patterns.testTemplateInline.test(e.template)?delete e.template:e.template=e.template.replace(a._patterns.testTemplateBasic,""),a._set(e),void c(e)):void a._method(f?e.template.replace(a._patterns.testTemplatePath,""):[[a._options.base,a._options.templateDirectory,b].join("/"),a._options.templateExtension].join(".")).then(function(c){if(a._ok.includes(c.status))return a._axios?c.data.toString():c.text();var e="template fetch failed ["+b+"]";return a._console("error",e),void d(e)}).then(function(f){if(!f||!f.length||!a._patterns.testTemplateString.test(f)){var g="template check failed ["+b+"]";return a._console("error",g),void d(g)}return e.template=f,a._set(e),void c(e)}).catch(function(c){a._console("error",c);var e="fetch template catch ["+b+"]";return a._console("error",e),void d(e)})}).catch(function(c){a._console("error",c);var e="fetch component catch ["+b+"]";return a._console("error",e),void d(e)})}:void this._console("error","missing required arguments")}}]),a}();
